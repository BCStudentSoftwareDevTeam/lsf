{% extends "base.html" %}

{% block styles %}
    {{super()}}
     <link rel="stylesheet" href="{{url_for('static', filename ='css/termManagement.css')}}">
{% endblock %}

{% block scripts %}
    {{super()}}
    <script type="text/javascript" src="{{url_for('static', filename='js/termManagement.js')}}"></script>
{% endblock %}

{% block app_content %}
<div class="container" id="wrapper">
  <b>
  <h1 id="termHeader">Term Management</h1>
  </b>
  <p id="subHeader">Click on the collapsible panel to open and close it.</p>

  <div class="accordion" id="accordionExample">
  {% for terms in listOfTerms %}   <!-- This loop creates the panels for the accordion, they contain "Academic Year: year-year" -->
    <div class="card">
      <div class="card-header" id="heading_{{terms[0]}}">
        <button class="btn btn-link"
          type="button"
          id="academicYear_{{terms[0]}}"
          data-toggle="collapse"
          data-target="#{{terms[0]}}"
          aria-expanded="true"
          aria-controls="{{terms[0]}}">
          <h4 class="mb-0">
          Academic Year: {{(terms[0]|string)[:4]}}-{{(((terms[0]|string)[:4])|int)+1}}        <!-- this was the only way to get the Academic year to show properly... sorry -->
          </h4>
        </button>
      </div>
      <div id="{{terms[0]}}"
            class="collapse"
            aria-labelledby="heading_{{terms[0]}}"
            data-parent="#accordionExample">
    <table class="table table-condensed" class="card-body" id="myTable">  <!-- This is the start of the table -->
      <thead>
        <tr id="tableHeaders">
            <th>Term Name</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Term State
                  <span data-toggle="tooltip"
                    data-tooltip="true"
                    title="Closing a term prevents you from adding labor forms to the term."
                    data-placement="right"
                    class="glyphicon glyphicon-bookmark">
                  </span>
            </th>
        </tr>
        </thead>
        <tbody>
          {% for term in terms %}   <!-- This loop is what brings in the terms for each Academic year in the table that is in the accordion panel -->
                <tr>
                  <td id="sizeTermName">{{term.termName}}</td>
                  <!-- checks to see if the start date is not empty -->
                  <td>
                    <div class="input-group date">
                      <input
                          id="start_{{term.termCode}}"
                          onchange="getDate(this, {{term.termCode}}); updateEnd(this, {{term.termCode}});"
                          type="text"
                          class="form-control datepicker start"
                          placeholder="MM/DD/YYYY"
                          value="{% if term.termStart != None %}{{term.termStart.strftime('%m/%d/%Y')}}{% endif %}"
                      />
                      <span class="input-group-addon">
                        <span class="glyphicon glyphicon-calendar"></span>
                      </span>
                    </div>
                  </td>
                  <td>
                    <div class="input-group date">
                      <input id="end_{{term.termCode}}"
                          onchange="getDate(this, {{term.termCode}}); updateStart(this, {{term.termCode}});"
                          type="text"
                          class="form-control datepicker emptyEnd"
                          placeholder="MM/DD/YYYY"
                          value="{% if term.termEnd != None %}{{term.termEnd.strftime('%m/%d/%Y')}}{% endif %}"
                      />
                      <span class="input-group-addon">
                          <span class="glyphicon glyphicon-calendar"></span>
                      </span>
                      </div>
                    </td>
                    <td>
                       <button
                         {% if term.termStart == None or term.termEnd == None or term.termState == None %} disabled {% endif %}
                         id="term_btn_{{term.termCode}}"
                         name="termBtn"
                         type="button"
                         class="btn btn-med {% if term.termState == True %} btn-success {% elif term.termState == False %} btn-danger {% endif %}"
                         onclick="termStatus({{term.termCode}})"
                         value="{{term.termState}}">{% if term.termState == True %} Open {% elif term.termState == False %} Closed {% endif %}
                       </button>
                     </td>
                  </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% endfor %}
  </div>
</div>
{% endblock %}
